---
:id: 2014-03-open-terminal-from-komodo
:slug: 2014-03-open-terminal-from-komodo
:title: Open Terminal From Komodo
:date: !ruby/object:DateTime 2014-03-16 20:00:00.000000000 -04:00
:tags:
- macro
- javascript
- editor
- terminal
:body: ! "\n<div class=\"centered\">\n<h2 style=\"font-weight: 300; margin: 10px 0
  25px 0\"><em>Macro Monday - a new macro to dig into every Monday!</em></h2>\n</div>\n\n<a
  href=\"/assets/images/blog/2014-03/openterminal.png\" class=\"lightbox\">\n    <img
  src=\"/assets/images/blog/2014-03/openterminal_thumb.png\" align=\"right\"/>\n</a>\n\nEver
  wanted to quickly jump from Komodo to your terminal? It's likely a common\noccurrance,
  one that [twitter user @mjatharvest was facing][tweet] and decided to tweet\nus
  about. Turns out it's pretty easy to add with a macro!\n\nAll I really had to do
  was inject a menu item into the relevant menupopup,\nattach a command to it that
  launches a terminal in the selected directory and\nvoila, we've got ourselves a
  new feature.\n\n```javascript\n/**\n * Adds an \"Open Terminal Here\" menu item
  to folder items in the Places widget\n *\n * @source https://github.com/Komodo/macros\n
  * @author Nathan Rijksen\n * @contributor Mathieu Strauch\n * @version 0.3\n */\n\n//
  Register namespace\nif ((typeof extensions) == 'undefined') extensions = {};\nextensions.OpenTerminalHere
  = {};\n\n(function()\n {\n\n    // Get places pane document object\n    var d =
  document.getElementById('placesViewbox').contentDocument;\n\n    // Remove existing
  menu entry if it exists\n    var mi = d.getElementById('contextOpenTerminalHere');\n
  \   if (mi) mi.parentNode.removeChild(mi);\n\n    // Get the sibling element which
  we want to insert our menu item after\n    var sibling = d.getElementById('placesContextMenu_rename');\n\n
  \   var platform = navigator.platform.toLowerCase();\n\n    // Create our menu item\n
  \   mi = document.createElement(\"menuitem\");\n    mi.setAttribute(\"id\", \"contextOpenTerminalHere\");\n
  \   mi.setAttribute(\"hideIf\", \"file project\");\n    mi.setAttribute(\"label\",
  \"Open Terminal Here\");\n\n    // Add event listener for when the menu item is
  used\n    mi.addEventListener('command', function(e)\n    {\n        uris = ko.places.viewMgr.getSelectedURIs()\n
  \       if ( ! uris.length) return;\n        path = uris[0].replace(/^[a-zA-Z]+:\\/\\//,'');\n\n
  \       // Prepare command for each platform\n        var command;\n        if (platform.indexOf(\"mac\")
  != -1) // Mac / OSX -- terminal\n            command = 'osascript -e \\'tell application
  \"terminal\"\\' -e \\'do script \\\n                      \"cd \\\\\"' + path +
  '\\\\\"\"\\' -e \\'activate\\' -e \\'end tell\\'';\n        else if (platform.indexOf(\"linux\")
  != -1) // Linux -- gnome-terminal\n            command = 'gnome-terminal --working-directory=\"'
  + path + '\"';\n        else if (platform.indexOf(\"win\") != -1) // Windows --
  command prompt\n        {\n            path = path.replace(/^(?:[a-z]*:\\/\\/|\\/)/i,'');\n
  \           command = 'start cmd /K \"cd ' + path + '\"';\n        }\n\n        //
  Run command, dont show output window\n        ko.run.runCommand(window, command,
  {env: null}, null, null, null, true, 'no-console');\n    });\n\n    // Append menu
  item to popupmenu\n    sibling.parentNode.insertBefore(mi, sibling);\n\n}).apply(extensions.OpenTerminalHere);\n```\n\nNote
  I like to be a little verbose with my code, as I like it to be easy to read\nand
  understand. I could likely make this fit into about 10 lines if I'd want to.\n\n##
  Installation\n\nTo install the macro simply hit the download button below, then
  drag the downloaded\nfile into your [Komodo toolbox](http://docs.activestate.com/komodo/latest/toolbox.html).\nOnce
  in your toolbox double click the macro to activate it. The macro will\nautomatically
  activate itself the next time you start Komodo, you only need to\ndo this manually
  the first time.\n\n<div class=\"inline centered\">\n<a href=\"/files/macros/Open_Terminal_Here.komodotool\"
  class=\"button primary\">\n    <i class=\"icon icon-download\"></i>\n    Download
  Macro\n</a>\n<div class=\"spacer-half\"></div>\n<span>\n    <i class=\"icon icon-github\"></i>\n
  \   <a href=\"https://github.com/Komodo/macros/blob/master/Open_Terminal_Here.js\"
  target=\"_blank\">View Source</a>\n</span>\n</div>\n\n## Usage\n\nTo use the macro,
  simply right click a folder in your Places widget (the left\nside pane with all
  the files and folders) and select \"Open Terminal Here\".\n\nIf you would like to
  use this functionality from a different popupmenu, please feel\nfree to fork this
  code and customize it to your liking.\n\n## Going Even Further\n\nMy next little
  side project will be to actually add a terminal into Komodo. I've\nbeen impressed
  by \"[butterfly]\" and will likely be injecting that into Komodo and\nopen up the
  userscript / userstyle functionality to users once [butterfly] implements\nit.\n\n
  \  [tweet]: https://twitter.com/mjatharvest/status/438733525332680705 \"View the
  tweet that lead to this macro\"\n   [butterfly]: http://paradoxxxzero.github.io/2014/02/28/butterfly.html
  \"butterfly your everyday terminal in your web browser\"\n"
:comments: true
:author:
- :id: 6NplBEswso2aMQSyW2iWCe
  :name: Nathan Rijksen
  :biography: Nathan Rijksen is a Komodo developer with web dev expertise. He has
    experience as a backend architect, application developer and database engineer,
    and has worked with third-party authentication and payment modules. Nathan is
    a long time Komodo user and has written multiple macros and extensions before
    joining the Komodo team.
  :profilePhoto:
    :title: NathanRijksen
    :url: //images.contentful.com/bj1g69m2935w/5hTDHHCCtGiW48aU8EKmqo/16ebc63a407a1f3ad30c109aa06415a6/NathanRijksen.jpg
